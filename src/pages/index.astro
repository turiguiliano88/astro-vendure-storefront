---
import Base from '../layouts/base.astro';
import Nav from '../components/Nav'
import { CardTitle, CardContent, Card } from '../components/ui/Card';
import ItemCard from '../components/ItemCard';
import { getProducts, getActiveCustomer } from '../api/server';
// import HomePage from '../components/HomePage'
import App from '../home-page'

const data = await getProducts();
const products = data.products;
// const _products = data.products;
// const {products} = Astro.props;
// const url = new URL(Astro.request.url);
// const token = url.searchParams.get('auth_token');
// console.log()
// console.log('header', Astro.request.headers.get('vendure'))



//   console.log('response', response)
// const customer = (await getActiveCustomer()).activeCustomer;
let customerName;
// if (customer) {
// 	customerName = `${customer?.firstName} ${customer?.lastName}`
// }
---

<Base title="Home">
<App client:load products={products} />
<!-- <HomePage client:load products={products} /> -->
<!-- <Nav client:load customerName={customerName} />
<div class="max-w-7xl my-lg mx-auto">
	<Card>
	<CardTitle>Our offers</CardTitle>
	<CardContent>
		<div class="flex flex-wrap">
		{products.items?.map((item) => {
			return (
			<div class="w-1/2 md:w-1/3 xl:w-1/4">
				<ItemCard
				img_url={item.featuredAsset.preview}
				path={`product/${item.slug}`}
				name={item.name}
				price={item.variants[0].price}
				/>
			</div>
			);
		})}
		</div>
	</CardContent>
	</Card>
</div> -->
</Base>